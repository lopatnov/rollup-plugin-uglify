{"version":3,"file":"plugin.umd.js","sources":["../src/plugin.ts"],"sourcesContent":["import { Plugin, TransformPluginContext } from \"rollup\";\r\nimport { minify, MinifyOptions } from \"terser\";\r\nimport { createFilter } from \"@rollup/pluginutils\";\r\n\r\nexport interface IUglifyOptions extends MinifyOptions {\r\n  include?: string | RegExp;\r\n  exclude?: string | RegExp;\r\n}\r\n\r\nfunction uglify(options: IUglifyOptions = {}): Plugin {\r\n  const filter = createFilter(options.include, options.exclude);\r\n  delete options.include;\r\n  delete options.exclude;\r\n  \r\n  return {\r\n    name: \"uglify\",\r\n    async transform(this: TransformPluginContext, code: string, id: string) {\r\n      if (!filter(id)) {\r\n        return null;\r\n      }\r\n\r\n      if (typeof options.sourceMap === \"undefined\") {\r\n        options.sourceMap = true;\r\n      }\r\n\r\n      const result = await minify(code, options);\r\n\r\n      if (!result || !result.code) {\r\n        throw new Error(\"Minification failed: no result\");\r\n      }\r\n\r\n      return {\r\n        code: result.code,\r\n        map: result.map as any,\r\n      };\r\n    },\r\n  };\r\n}\r\n\r\nexport { uglify };\r\nexport default uglify;\r\n"],"names":["createFilter","minify"],"mappings":";;;;;;IASA,SAAS,MAAM,CAAC,OAAA,GAA0B,EAAE,EAAA;IAC1C,IAAA,MAAM,MAAM,GAAGA,wBAAY,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC;QAC7D,OAAO,OAAO,CAAC,OAAO;QACtB,OAAO,OAAO,CAAC,OAAO;QAEtB,OAAO;IACL,QAAA,IAAI,EAAE,QAAQ;IACd,QAAA,MAAM,SAAS,CAA+B,IAAY,EAAE,EAAU,EAAA;IACpE,YAAA,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;IACf,gBAAA,OAAO,IAAI;gBACb;IAEA,YAAA,IAAI,OAAO,OAAO,CAAC,SAAS,KAAK,WAAW,EAAE;IAC5C,gBAAA,OAAO,CAAC,SAAS,GAAG,IAAI;gBAC1B;gBAEA,MAAM,MAAM,GAAG,MAAMC,aAAM,CAAC,IAAI,EAAE,OAAO,CAAC;gBAE1C,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;IAC3B,gBAAA,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC;gBACnD;gBAEA,OAAO;oBACL,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,GAAG,EAAE,MAAM,CAAC,GAAU;iBACvB;YACH,CAAC;SACF;IACH;;;;;;;;;;;"}